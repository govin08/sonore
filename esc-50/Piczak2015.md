# Abstract
Environmental sound classification 연구에서의 한가지 장애물은 publicly available하고 suitable한(적당한) 데이터셋이 없다는 것이다.
이 논문에서는 라벨이 달린 2000개의 짧은 소리파일들(short clips)을 제공함으로써 이 문제를 다루려 한다.
또한 라벨이 없는 250000개의 소리 파일들도 제공한다.
이 데이터들에 대하여 인간의 분류 정확도와 baseline 모델의 정확도도 제시한다.
여기서 baseline 모델이란 mel-frequency cepstral coefficient를 사용한 방법과 zero-crossing rate을 사용한 방법을 말한다.

# 1. Introduction
(1) machine perception 분야, 특히 visual recognition의 발흥에 대해 언급하고 있다.
(2) 그중에서도 auditory recognition task에 대해 이야기하고 있다.
auditory recognition task는 주로 speech나 music에 한정된 연구가 많다.
반면 environmental sound에 대한 연구는, 상당히 많은 적용가능성에도 불구하고 많이 부족하다는 것이다.
(3) 이 분야에 대한 연구에서의 한가지 장애는 comparability(비교가능성)과 reproducibility(재현가능성)이다.
특정한(specific), 작은(small) 혹은 상표가 붙은(proprietary) 데이터셋이 많다는 것이다.
이것은 computer vision 분야에서 MNIST나 CIFAR 같은 표준적인 데이터셋이 있는 것과는 극명한 대조를 이룬다.
(4) 이 논문의 목적은 environmental sound classification 분야의 open research를 촉진시키기 위함이다 ;
- 모두가 사용 가능한 데이터셋을 제공한다.
- 인간이 직접 분류했을 때의 정확도를 측정한다.
- 머신러닝 기법을 사용한 baseline classifier와 그 성능을 살펴본다.
- 이 결과들에 대하여 파이썬 코드를 제공한다.

# 2. The ESC dataset

데이터셋은 세 부분으로 나뉜다.
(1) 50개의 클래스로 분류된 다양한 환경 소리로 이루어진 메인 데이터셋, (2) POC목적의 10개 클래스의 데이터셋으로 메인 데이터세의 부분집합, (3) 라벨이 없는 추가적인 데이터셋으로 비지도학습에 사용될 수 있는 데어터셋.

모든 데이터들은 Freesound 에서 가져왔음.
라벨이 달린 데이터들은 임의로 뽑혔으나 완전히 무작위는 아니고 소리의 주요 타입들 간의 균형을 유지하며 추출되었음.
또한 각 클래스의 샘플 수에 대한 제한과 소리의 다양성에 대한 고려도 포함되었음.
또한, 각 클래스에 대한 유용성과 차별성도 주관적으로 판단되었음.
Freesound에서 클래스명(상용 언어)로 검색한 후 나오는 소리 파일을 author가 각각 평가하고 검증하여 annotation을 달아놓았음.
이 annotation을 사용해 5초 길이의 소리 파일을 만들어냈고, 일정한 형식(44.1kHz, 192kbit/s)으로 변환했음.
파일들은 5-fold로 저장된 것으로 보임.
즉, 4000개의 라벨이 달린 소리는 5종류의 카테고리로 나뉘고 40개씩 50 종류의 클래스로 나뉨.
그런데 4000개의 소리는 5개읠 fold로 나뉨
같은 원본오디오파일에서 추출된 소리들은 모두 같은 fold 안에 속함.
이것은 이후 cross validation시 (test set으로의) 데이터 누출을 방지하기 위한 것으로 보임.

데이터셋은 Creative Commons의 비영리적 라이센스 하에 있고 Havard Dataverse에 속해있음(?).
ipynb파일과 함께 있어서, 이 짧은 논문에서 담을 수 없는 많은 내용들을 ipynb파일에서 열람할 수 있음.

## 2.1 ESC-50

ESC-50은 2000개의 라벨이 달린 환경녹음 소리로 이루어져 있음.
클래스의 수는 50개이고 각 클래스마다 40개의 소리가 있음.
50개의 클래스는 다음과 같이 5 종류의 카테고리로 나뉘며, 한 카테고리마다 10개의 클래스가 있음.
- 동물 소리
- 자연 소리 및 물소리
- 인간 소리
- 실내 소리 및 집안 소리
- 실외 소리 및 도시 소리

추출과정에서 각각의 소리들은 전면에 있는 (in the foreground) 소리여야 하고 가능한 한 다른 배경소리가 제한되어야 한다는 원칙이 있음.
하지만 여의치 않을 경우에는 배경소리가 조금씩 겹쳐있을 수 있음.

다양한 소리가 포함되어 있음 ; 평범한 소리 (웃음, 고양이가 우는 것, 개가 짖는 것), 특이한 소리 (유리가 깨지는 것, 이를 닦는 것), 특정한 뉘앙스를 가진 소리(?) (헬리콥터나 비행기 소리)

아마도 이 데이터셋의 약점이라고 할만한 것은 데이터 샘플 수가 적다는 것에 있을 것이다.
직접 annotation하고 추출하는 것이 많은 비용이 들기 때문이었다.
또한, 특이한 형태의 소리에 대해서는 얻는 것이 더 제한적임에도 불구하고 클래스들 간의 균형을 유지하려는 결정 때문이기도 하다.
그런 단점들에도 불구하고 이 데이터셋이 이 형태 그대로 쓰일 수 있기를, 또한 이러한 개념들이 잘 유지되어 확장되기를 기대한다.

## 2.2 ESC-10

ESC-10은 10개의 클래스만을 뽑아 선별한 것으로 다음과 같은 세 개의 그룹의 소리들이다.
- 일시적인 또는 타악기성의 소리들. 혹은 특정한 패턴을 지닌 것들 : 코를 푸는 소리, 개가 짖는 소리, 시계가 딸깍대는 소리
- strong harmonic content가 있는 소리 : 아이가 우는 소리, 닭이 우는 소리
- 얼마간 정형화된 소리 : 빗소리, 파도소리, 나무 타는 소리, 헬리콥터 소리, 전기톱소리

이 부분데이터셋은 좀 더 시작하기 쉬운 문제를 제공하고, POC 데이터셋으로 초기에 구성하기 좋은 데이터셋이다.
인간의 관점에서 이 데이터셋을 분류하는 것은 쉬운 일에 속할 것이고 자동적인 소리인식 시스템을 구축하더라도 높은 정확성을 보일 것이 예상된다.
그러므로 ESC-50 전체 데이터셋과는 조금 다른 문제가 될 것이다.
클래스들 간의 차이점이 비교적 명확하고 모호성이 적으며 (ESC-50을 다룰 때와는) 다른 머신러닝 기법이 더 잘 작동할 수 있다.

## 2.3 ESC-US

불행하게도 라벨된 데이터 인스턴스들의 갯수가 너무 적어서, 데이터로부터 representation을 학습하는 식의 방법을 적용하는 데는 부적절할 수도 있다.
이것을 완화하기 위해 25만개의 추가적인 데이터셋이 같은 길이의 숏클립으로 제공된다.
이 데이터셋은 비지도적인 pre-training이나 생성형 모델에 적당할 수 있다.

ESC-US가 hand-annotated 방식이 아니지만, 그래도 메타데이터(태그, sound description)를 포함하고 있다.
하지만, 라벨과는 달리 저자가 직접 다 확인한 것이 아니다.

그러므로 이 데이터셋은 군집화 및 매니폴드 러닝 실험이면 몰라도 그렇지 않은 경우에는 약한 지도학습 조건에서만 사용될 수 있을 것이다.

# 3. Sound Classification

## 3.1 Human classification accuracy

인간의 청각체계는 과다한 소리 자극을 인식하는 데 있어서 문제가 없는 편이다.
그러므로 이 데이터셋을 가지고 하는 제한적인 도전에서 sound event를 적절히 인식하는 것은 전혀 어렵지 않을 것이다.
진짜 질문은 "얼마나 쉬운가"가 될 것이다.
이 질문에 대답하기 위해 CrowdFlower라는 크라우드소싱 플랫폼을 통해 수많은 참여자들이 라벨이 달린 이 데이터셋의 소리들을 최대한 잘 분류하라고 요구받았다.

실험은 다양한 소리들을 참가자들에게 제시하고 그들에게 10개 혹은 50개의 카테고리에서 선택하라고 요구하는 방식으로 이루어졌다.
참가자들은 한 단위의 일 (10개의 소리를 듣고 분류하는 것)을 끝날 때마다 일정한 보수를 받았다.
quality control(품질 관리)은 CrowdFlower의 내부 과정으로 진행되었다.
최종 결과는 저자에 의해 더 평가되어 이상치로 보이는 것들은 쳐냈고 소수의 entry들은 여기서 제거되었다.
그 결과 각 데이터셋마다 약 4000개의 judgement가 수집되었다.
이런 실험 세팅에서 정식의 통계적인 추정을 얻어내는 것이 힘들지 몰라도, 인간의 일상 소리의 인식능력에 대한 추정치는 제공할 수밖에 없을 것이다.

평균 정확도(accuracy)는 ESC-10에서 95.7%이고 ESC-50에서 81.3%였다.
재현율(recall)은 소리의 타입에 따라 매우 달랐다.
그러니까 여기서 재현율이란 무언가.
당연히 TP / (TP+FN)이다.
예를 들어 개짖는 소리라고 하면, TP+FN은 label이 positive인 것들의 개수이다.
총 40개의 소리들에 해당하는 instances가 분모가 되겠다.
그중에 TP니까, 개짖는 소리를 맞춘 개수가 분자가 되겠다.
그러니까 개짖는 소리들 중 맞춘 것의 비율을 구하는 것이 될텐데, 이 비율(recall)이 개짖는 소리인지, 아이 울음소리인지 비행기 소리인지에 따라서 달라진다는 거다.
예를 들어 세탁기 소리는 recall이 34.1%로 나왔고 아이 울음소리와 개짖는 소리는 거의 100%로 나왔다.
세부적인 사항은 ipynb 파일에 담겨 있으니 여기서는 더 언급하지 않고,  데이터셋의 소리들이 난이도로 따졌을 때 다음의 세 난이도로 나타남을 언급하겠다.
- 쉬운 카테고리 : 대부분의 사람 소리, 동물소리, 분명한 소리 (사이렌, 물떨어지는 소리, 유리 깨지는 소리)
- 중간 카테고리
- 어려운 카테고리 : 풍경소리와 기계소리

이런 실험에서의 어려움 중 하나는 카테고리의 수가 증가할 수록 숙련되지 않은 참가자들에게는 분류하는 데 어려움을 겪었다는 사실이다. (아마도 주어진 그림이 어떤 major group인지 (5개의 major category) 알려준 것으로 보이는데) 50개의 클래스를 분류하는 문제에서 일관된 시각을 가졌다고 보이는데, 아마 더 늘렸으면 이게 깨졌을 수 있었을 것이다.

그럼에도 불구하고 이런 실험으로 비추어 볼 때 숙련되고 주의깊은 청취자(피실험자)들은 ESC-10에 대해서는 다 맞추고 ESC-50에 대해서도 90%에 가까운 정확도를 보였다. 다만, 기계소리나 풍경소리에 대해서는 약간의 오차가 존재했다.

## 3.2 Baseline machine classification results

인간의 능력에 가까운 바람직한 목표 정확도가 얼마정도일지 알았으니 다음 목표는 기계를 통한 분류는 얼만큼 성취될 수 있는지 살펴보는 것이다.
이 분석의 목적은 최대한 robust한 체계를 만들어내자는 것이 아니라 기본적인 접근법을 통해 이 데이터셋의 가능한 위험이나 곤란한 점을 살펴보는 것이다.

각각의 클립(소리 파일)마다 두 종류의 feature들이 추출된다 : zero crossing rate와 MFCC.
전자는 매우 간단하지만 유용하다.
반면 후자는 음성 처리나 harmonic content를 분석할 때 늘 쓰이는 것이다.
MFCC는 librosa를 통해 계산되었고 기본값 그대로 사용하였으나 frame length는 11.6ms로 두었다.
0번째 계수는 제거한 채로 12개의 계수와 zero-crossing rate가 평균 및 표준편차와 함께 각각의 클립에서 추출되었다.
이렇게 만들어진 feature vector는 K-NN, random forest ensemble, SVM with linear kernel에 입력값으로 들어갔다.
학습은 5-fold cross validation regime으로 수행되었다.

결과는 다음과 같다. (전자 : ESC-10, 후자 : ESC-50)
- K-NN              66.7%, 32.2%
- random forest     72.7%, 44.3%
- SVM               67.5%, 39.6%

ESC-10에서 fold에 따른 성능 차이가 나타나는데 이것은 데이터 크기가 적어서 그런 것으로 보인다.
다만 ESC-50에서 이런 차이는 줄어든다.

분류기들 간에 나타나는 경향 중 하나는 가장 간단한 모델인 k-NN 모델이, ESC-10에서 ESC-50으로 갈 때 정확도가 떨어졌다는 것이다.
아마도 데이터셋이 복잡해지면  feature들 사이의 의존도가 복잡해지기 때문에 복잡한 모델이 더 그런 특성을 잘 잡아내는 것으로 보인다.

일반적으로, 이런 기본적인 분류기가 인간에 비해 매우 낮은 성능을 보였고 그 차이는 몇몇 클래스에서 두드러졌다.
예를 들어, 풍경소리나 배경소리는 인간 청취자들에게는 모호하게 들렸는데 기계 분류기들은 높은 성능을 보였다.

SVM은 동물 소리에서 random forest를 능가했다.
이것은 데이터의 특성 때문일 수도 있겠지만, 특정 분야에 한정해서는 다른 모델이 더 우수할 수 있다는 것을 보여주는 것 같다고 한다.

이 baseline model들은 상대적으로 매우 간단한 모델이라는 점은 언급되지 않을 수 없다.
예를 들면 CNN을 사용한 최근의 접근법이 더 robust할 수 있다.

# 4. Summary

이 논문의 목표는 공공의 목적으로 사용할 수 있는 데이터들이 풍부하지 않은 연구 영역에서, 환경 소리에 대한 새로운 데이터셋을 제시하는 데에 있다.
이 자료가 환경 소리를 분석하는 데 있어서 좀 더 열린 연구를 촉진할 수 있었으면 한다.

